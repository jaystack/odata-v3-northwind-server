// JayData 1.5.5 RC
// Dual licensed under MIT and GPL v2
// Copyright JayStack Technologies (http://jaydata.org/licensing)
//
// JayData is a standards-based, cross-platform Javascript library and a set of
// practices to access and manipulate data from various online and offline sources.
//
// Credits:
//     Hajnalka Battancs, Dániel József, János Roden, László Horváth, Péter Nochta
//     Péter Zentai, Róbert Bónay, Szabolcs Czinege, Viktor Borza, Viktor Lázár,
//     Zoltán Gyebrovszki, Gábor Dolla
//
// More info: http://jaydata.org
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("jaydata/odata",["jaydata/core"],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.$data=e()}}(function(){return function e(t,r,a){function n(o,s){if(!r[o]){if(!t[o]){var d="function"==typeof require&&require;if(!s&&d)return d(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var p=r[o]={exports:{}};t[o][0].call(p.exports,function(e){var r=t[o][1][e];return n(r?r:e)},p,p.exports,e,t,r,a)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.strategy=void 0;var n=e("jaydata/core"),i=a(n),o={name:"batch",condition:function(e,t){var r=!1;if(r="undefined"!=typeof e.providerConfiguration.disableBatch?!!e.providerConfiguration.disableBatch:!!i["default"].defaults.OData.disableBatch,!r){var a=t.getItems();return a.length>1}return!1},save:function(e,t,r){var a=e,o=t.getItems(),s=o.map(function(e){return e.request.build().get()}),d=[{requestUri:a.providerConfiguration.oDataServiceHost+"/$batch",method:"POST",data:{__batchRequests:[{__changeRequests:s}]},headers:{}},function(e,o){if(200==o.statusCode||202==o.statusCode){for(var s=e.__batchResponses[0].__changeResponses,d=[],u=0;u<s.length;u++)if(s[u].statusCode>=200&&s[u].statusCode<300){var p=t.getByResponse(s[u],u);p instanceof i["default"].Entity&&204!=s[u].statusCode&&(a.reload_fromResponse(p,s[u].data,s[u]),t.setProcessed(p))}else d.push(a.parseError(s[u]));d.length>0?1===d.length?r.error(d[0]):r.error(new n.Exception("See inner exceptions","Batch failed",d)):r.success&&r.success(t.length)}else r.error(a.parseError(o))},function(e){r.error(a.parseError(e))},a.oData.batch.batchHandler];"undefined"!=typeof a.providerConfiguration.useJsonLight&&(d[0].useJsonLight=a.providerConfiguration.useJsonLight),a.appendBasicAuth(d[0],a.providerConfiguration.user,a.providerConfiguration.password,a.providerConfiguration.withCredentials),a.context.prepareRequest.call(a,d),a.oData.request.apply(a,d)}};r.strategy=o},{"jaydata/core":"jaydata/core"}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={name:"empty",condition:function(e,t){return!0},save:function(e,t,r){r.success(0)}};r.strategy=a},{}],3:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.strategy=void 0;var n=e("jaydata/core"),i=a(n),o={name:"single",condition:function(e,t){var r=t.getItems();return r.length>0},save:function(e,t,r){var a=e,n=t.getItems(),o=function s(e,r,n){var o=e[r];if(!o)return n();var d=o.request.build().get(),u=[d,function(o,d){if(d.statusCode>=200&&d.statusCode<300){var u=t.getByResponse(d,r);u instanceof i["default"].Entity&&204!=d.statusCode&&(a.reload_fromResponse(u,o,d),t.setProcessed(u)),s(e,++r,n)}else n(d)},n];a.appendBasicAuth(u[0],a.providerConfiguration.user,a.providerConfiguration.password,a.providerConfiguration.withCredentials),a.context.prepareRequest.call(a,u),a.oData.request.apply(a,u)};o(n,0,function(e,t){return e?r.error(a.parseError(e)):void r.success(t)})}};r.strategy=o},{"jaydata/core":"jaydata/core"}],4:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("jaydata/core"),i=a(n),o=e("./oDataConverter.js"),s=(a(o),e("./oDataProvider.js")),d=(a(s),e("./oDataCompiler.js")),u=(a(d),e("./oDataWhereCompiler.js")),p=(a(u),e("./oDataIncludeCompiler.js")),l=(a(p),e("./oDataOrderCompiler.js")),f=(a(l),e("./oDataPagingCompiler.js")),c=(a(f),e("./oDataProjectionCompiler.js"));a(c);r["default"]=i["default"],t.exports=r["default"]},{"./oDataCompiler.js":5,"./oDataConverter.js":6,"./oDataIncludeCompiler.js":7,"./oDataOrderCompiler.js":8,"./oDataPagingCompiler.js":9,"./oDataProjectionCompiler.js":10,"./oDataProvider.js":11,"./oDataWhereCompiler.js":13,"jaydata/core":"jaydata/core"}],5:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var n=e("jaydata/core"),i=a(n);(0,n.$C)("$data.storageProviders.oData.oDataCompiler",i["default"].Expressions.EntityExpressionVisitor,null,{constructor:function(){this.context={},this.provider={},this.includes=null,this.mainEntitySet=null},compile:function(e){this.provider=e.context.storageProvider,this.context=e.context,e.defaultType&&(this.mainEntitySet=e.context.getEntitySetFromElementType(e.defaultType));var t={urlText:""};this.Visit(e.expression,t),t.$expand&&(t.$expand=t.$expand.toString()),e.modelBinderConfig={};var r=n.Container.createModelBinderConfigCompiler(e,this.includes,!0);r.Visit(e.expression);var a=t.urlText,i=!1;t.$funcParams&&(a+="("+t.$funcParams+")");for(var o in t)"urlText"!=o&&"actionPack"!=o&&"data"!=o&&"lambda"!=o&&"method"!=o&&"postData"!=o&&"_isBatchExecuteQuery"!=o&&"_subQueries"!=o&&"$funcParams"!=o&&""!=t[o]&&(a+=i?"&":"?",i=!0,a+="$urlParams"!=o?o+"="+t[o]:t[o]);e.queryText=a,e.postData=t.postData;var s={queryText:a,withInlineCount:"$inlinecount"in t||"$count"in t,method:t.method||"GET",postData:t.postData,isBatchExecuteQuery:t._isBatchExecuteQuery,subQueries:t._subQueries,params:[]};return e._getComplitedData=function(){return s},s},VisitOrderExpression:function(e,t){this.Visit(e.source,t);var r=n.Container.createoDataOrderCompiler(this.provider);r.compile(e,t)},VisitPagingExpression:function(e,t){this.Visit(e.source,t);var r=n.Container.createoDataPagingCompiler(this.provider);r.compile(e,t)},VisitIncludeExpression:function(e,t){this.Visit(e.source,t);var r=n.Container.createoDataIncludeCompiler(this.provider);this.includes=this.includes||[];var a={data:t.$expand,includes:this.includes};r.compile(e.selector,a),t.$expand=a.data},VisitFindExpression:function(e,t){if(this.Visit(e.source,t),e.subMember&&(t.urlText+="/"+e.subMember.memberName),t.urlText+="(",1===e.params.length){var r=e.params[0],a=n.Container.resolveName(r.type),i=this.provider.fieldConverter.toDb[a],o=i?i(r.value):r.value;i=this.provider.fieldConverter.escape[a],o=i?i(r.value):r.value,t.urlText+=o}else for(var s=0;s<e.params.length;s++){var r=e.params[s],a=n.Container.resolveName(r.type),i=this.provider.fieldConverter.toDb[a],o=i?i(r.value):r.value;i=this.provider.fieldConverter.escape[a],o=i?i(r.value):r.value,s>0&&(t.urlText+=","),t.urlText+=r.name+"="+o}t.urlText+=")"},VisitProjectionExpression:function(e,t){this.Visit(e.source,t);var r=n.Container.createoDataProjectionCompiler(this.provider);r.compile(e,t)},VisitFilterExpression:function(e,t){this.Visit(e.source,t);var r=n.Container.createoDataWhereCompiler(this.provider);t.data="",r.compile(e.selector,t),t.$filter=t.data,t.data=""},VisitInlineCountExpression:function(e,t){this.Visit(e.source,t),"4.0"===this.provider.providerConfiguration.maxDataServiceVersion?t.$count="allpages"===e.selector.value:t.$inlinecount=e.selector.value},VisitEntitySetExpression:function(e,t){if(t.urlText+="/"+e.instance.tableName,e.params)for(var r=0;r<e.params.length;r++)this.Visit(e.params[r],t)},VisitServiceOperationExpression:function(e,t){if(e.boundItem&&(t.urlText+="/"+e.boundItem.entitySet.tableName,e.boundItem.data instanceof i["default"].Entity&&(t.urlText+="("+this.provider.getEntityKeysValue(e.boundItem)+")")),t.urlText+="/"+(e.cfg.namespace?e.cfg.namespace+"."+e.cfg.serviceName:e.cfg.serviceName),t.method=t.method||e.cfg.method,e.params){t.serviceConfig=e.cfg;for(var r=0;r<e.params.length;r++)this.Visit(e.params[r],t);delete t.serviceConfig}},VisitBatchDeleteExpression:function(e,t){this.Visit(e.source,t),t.urlText+="/$batchDelete",t.method="DELETE"},VisitConstantExpression:function(e,t){var r=n.Container.resolveName(e.type);e.value instanceof i["default"].Entity&&(r=i["default"].Entity.fullName);var a=this.provider.fieldConverter.toDb[r],o=a?a(e.value,e):e.value;if("GET"!==t.method&&t.method)t.postData=t.postData||{},t.postData[e.name]=o;else if(a=this.provider.fieldConverter.escape[r],o=a?a(o,e):o,void 0!==o){var s=t.serviceConfig||{},d=s&&s.params.filter(function(t){return t.name==e.name})[0]||{},u=s.namespace&&(d.useAlias||s.useAlias||this.provider.providerConfiguration.useParameterAlias||i["default"].defaults.OData.useParameterAlias),p=u?"@"+e.name:o,l=(u?"@":"")+e.name;s.namespace&&(t.$funcParams?t.$funcParams+=",":t.$funcParams="",t.$funcParams+=e.name+"="+p),s.namespace&&!u||(t.$urlParams?t.$urlParams+="&":t.$urlParams="",t.$urlParams+=l+"="+o)}},VisitCountExpression:function(e,t){this.Visit(e.source,t),t.urlText+="/$count"},VisitBatchExecuteQueryExpression:function(e,t){t.urlText+="/$batch",t.method="POST",t.postData={__batchRequests:[]},t._isBatchExecuteQuery=!0,t._subQueries=e.members;for(var r=0;r<e.members.length;r++){var a=e.members[r],n=new i["default"].storageProviders.oData.oDataCompiler,o=n.compile(a);t.postData.__batchRequests.push({requestUri:this.provider.providerConfiguration.oDataServiceHost+o.queryText,method:o.method,data:o.data,headers:o.headers})}}},{})},{"jaydata/core":"jaydata/core"}],6:[function(e,t,r){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var a=e("jaydata/core"),n=r(a),i="undefined"!=typeof window?window.atob:"undefined"!=typeof t?t.atob:null,o=r(i);n["default"].defaults=n["default"].defaults||{},n["default"].defaults.oDataWebApi=!1,n["default"].oDataConverter={fromDb:{"$data.Enum":function(e,t){return n["default"].Container.convertTo(e,t)},"$data.Byte":n["default"].Container.proxyConverter,"$data.SByte":n["default"].Container.proxyConverter,"$data.Decimal":function(e){return n["default"].Container.convertTo(e,n["default"].Decimal)},"$data.Float":n["default"].Container.proxyConverter,"$data.Int16":n["default"].Container.proxyConverter,"$data.Int64":function(e){return n["default"].Container.convertTo(e,n["default"].Int64)},"$data.ObjectID":n["default"].Container.proxyConverter,"$data.Integer":n["default"].Container.proxyConverter,"$data.Int32":n["default"].Container.proxyConverter,"$data.Number":n["default"].Container.proxyConverter,"$data.Date":function(e){return e?e instanceof Date?e:"/Date("===e.substring(0,6)?new Date(parseInt(e.substr(6))):(-1!==e.indexOf("Z")||e.match("T.*[+-]")||(e+="Z"),new Date(e)):e},"$data.DateTimeOffset":function(e){return e?e instanceof Date?e:"/Date("===e.substring(0,6)?new Date(parseInt(e.substr(6))):(-1!==e.indexOf("Z")||e.match("T.*[+-]")||(e+="Z"),new Date(e)):e},"$data.Time":function(e){return n["default"].Container.convertTo(e,n["default"].Time)},"$data.Day":n["default"].Container.proxyConverter,"$data.Duration":n["default"].Container.proxyConverter,"$data.String":n["default"].Container.proxyConverter,"$data.Boolean":n["default"].Container.proxyConverter,"$data.Blob":function(e){if("string"!=typeof e)return e;try{return n["default"].Container.convertTo((0,o["default"])(e),"$data.Blob")}catch(t){return e}},"$data.Object":function(e){return void 0===e?new n["default"].Object:"string"==typeof e?JSON.parse(e):e},"$data.Array":function(e){return void 0===e?new n["default"].Array:e instanceof n["default"].Array?e:JSON.parse(e)},"$data.GeographyPoint":function(e){return e?new n["default"].GeographyPoint(e):e},"$data.GeographyLineString":function(e){return e?new n["default"].GeographyLineString(e):e},"$data.GeographyPolygon":function(e){return e?new n["default"].GeographyPolygon(e):e},"$data.GeographyMultiPoint":function(e){return e?new n["default"].GeographyMultiPoint(e):e},"$data.GeographyMultiLineString":function(e){return e?new n["default"].GeographyMultiLineString(e):e},"$data.GeographyMultiPolygon":function(e){return e?new n["default"].GeographyMultiPolygon(e):e},"$data.GeographyCollection":function(e){return e?new n["default"].GeographyCollection(e):e},"$data.GeometryPoint":function(e){return e?new n["default"].GeometryPoint(e):e},"$data.GeometryLineString":function(e){return e?new n["default"].GeometryLineString(e):e},"$data.GeometryPolygon":function(e){return e?new n["default"].GeometryPolygon(e):e},"$data.GeometryMultiPoint":function(e){return e?new n["default"].GeometryMultiPoint(e):e},"$data.GeometryMultiLineString":function(e){return e?new n["default"].GeometryMultiLineString(e):e},"$data.GeometryMultiPolygon":function(e){return e?new n["default"].GeometryMultiPolygon(e):e},"$data.GeometryCollection":function(e){return e?new n["default"].GeometryCollection(e):e},"$data.Guid":function(e){return e?e.toString():e}},toDb:{"$data.Enum":function(e,t){return null!==e&&void 0!==e?t&&t.getEnumName?t.getEnumName(e):"":e},"$data.Entity":n["default"].Container.proxyConverter,"$data.Byte":n["default"].Container.proxyConverter,"$data.SByte":n["default"].Container.proxyConverter,"$data.Decimal":n["default"].Container.proxyConverter,"$data.Float":n["default"].Container.proxyConverter,"$data.Int16":n["default"].Container.proxyConverter,"$data.Int64":n["default"].Container.proxyConverter,"$data.ObjectID":n["default"].Container.proxyConverter,"$data.Integer":n["default"].Container.proxyConverter,"$data.Int32":n["default"].Container.proxyConverter,"$data.Number":n["default"].Container.proxyConverter,"$data.Date":function(e){return e?e.toISOString().replace("Z",""):e},"$data.Time":n["default"].Container.proxyConverter,"$data.Day":n["default"].Container.proxyConverter,"$data.Duration":n["default"].Container.proxyConverter,"$data.DateTimeOffset":function(e){return e?e.toISOString():e},"$data.String":n["default"].Container.proxyConverter,"$data.Boolean":n["default"].Container.proxyConverter,"$data.Blob":function(e){return e?n["default"].Blob.toBase64(e):e},"$data.Object":n["default"].Container.proxyConverter,"$data.Array":function(e,t){if(e&&t&&t.elementType){for(var r=a.Container.resolveName(t.elementType),i=[],o=0;o<e.length;o++)i.push(n["default"].oDataConverter.toDb[r](e[o]));return i}return n["default"].Container.proxyConverter.apply(this,arguments)},"$data.GeographyPoint":n["default"].Container.proxyConverter,"$data.GeographyLineString":n["default"].Container.proxyConverter,"$data.GeographyPolygon":n["default"].Container.proxyConverter,"$data.GeographyMultiPoint":n["default"].Container.proxyConverter,"$data.GeographyMultiLineString":n["default"].Container.proxyConverter,"$data.GeographyMultiPolygon":n["default"].Container.proxyConverter,"$data.GeographyCollection":n["default"].Container.proxyConverter,"$data.GeometryPoint":n["default"].Container.proxyConverter,"$data.GeometryLineString":n["default"].Container.proxyConverter,"$data.GeometryPolygon":n["default"].Container.proxyConverter,"$data.GeometryMultiPoint":n["default"].Container.proxyConverter,"$data.GeometryMultiLineString":n["default"].Container.proxyConverter,"$data.GeometryMultiPolygon":n["default"].Container.proxyConverter,"$data.GeometryCollection":n["default"].Container.proxyConverter,"$data.Guid":n["default"].Container.proxyConverter},escape:{"$data.Enum":function(e,t){return null!==e&&void 0!==e?(t?t.fullName:"")+"'"+e+"'":e},"$data.Entity":function(e){return JSON.stringify(e)},"$data.Integer":n["default"].Container.proxyConverter,"$data.Int32":n["default"].Container.proxyConverter,"$data.Number":function(e){return e&&n["default"].defaults.oDataWebApi?e+"d":e},"$data.Int16":n["default"].Container.proxyConverter,"$data.Byte":n["default"].Container.proxyConverter,"$data.SByte":n["default"].Container.proxyConverter,"$data.Decimal":function(e){return e&&n["default"].defaults.oDataWebApi?e+"m":e},"$data.Float":function(e){return e&&n["default"].defaults.oDataWebApi?e+"f":e},"$data.Int64":n["default"].Container.proxyConverter,"$data.Time":n["default"].Container.proxyConverter,"$data.Day":n["default"].Container.proxyConverter,"$data.Duration":function(e){return e?"duration'"+e+"'":e},"$data.DateTimeOffset":function(e){return e?encodeURIComponent(e):e},"$data.Date":function(e){return e?"datetime'"+e+"'":e},"$data.String":function(e){return"string"==typeof e?"'"+e.replace(/'/g,"''")+"'":e},"$data.ObjectID":function(e){return"string"==typeof e?"'"+e.replace(/'/g,"''")+"'":e},"$data.Boolean":function(e){return"boolean"==typeof e?e.toString():e},"$data.Blob":function(e){return e?"binary'"+e+"'":e},"$data.Object":function(e){return JSON.stringify(e)},"$data.Array":function(e,t){if(e&&t&&t.elementType){for(var r=a.Container.resolveName(t.elementType),i=[],o=0;o<e.length;o++)i.push(n["default"].oDataConverter.escape[r](e[o]));return"["+i.join(",")+"]"}return JSON.stringify(e)},"$data.GeographyPoint":function(e){return e?n["default"].GeographyBase.stringifyToUrl(e):e},"$data.GeographyLineString":function(e){return e?n["default"].GeographyBase.stringifyToUrl(e):e},"$data.GeographyPolygon":function(e){return e?n["default"].GeographyBase.stringifyToUrl(e):e},"$data.GeographyMultiPoint":function(e){return e?n["default"].GeographyBase.stringifyToUrl(e):e},"$data.GeographyMultiLineString":function(e){return e?n["default"].GeographyBase.stringifyToUrl(e):e},"$data.GeographyMultiPolygon":function(e){return e?n["default"].GeographyBase.stringifyToUrl(e):e},"$data.GeographyCollection":function(e){return e?n["default"].GeographyBase.stringifyToUrl(e):e},"$data.GeometryPoint":function(e){return e?n["default"].GeometryBase.stringifyToUrl(e):e},"$data.GeometryLineString":function(e){return e?n["default"].GeometryBase.stringifyToUrl(e):e},"$data.GeometryPolygon":function(e){return e?n["default"].GeometryBase.stringifyToUrl(e):e},"$data.GeometryMultiPoint":function(e){return e?n["default"].GeometryBase.stringifyToUrl(e):e},"$data.GeometryMultiLineString":function(e){return e?n["default"].GeometryBase.stringifyToUrl(e):e},"$data.GeometryMultiPolygon":function(e){return e?n["default"].GeometryBase.stringifyToUrl(e):e},"$data.GeometryCollection":function(e){return e?n["default"].GeometryBase.stringifyToUrl(e):e},"$data.Guid":function(e){return e?""+e.toString():e}},unescape:{"$data.Entity":function(e,t){var r=t||{},n=JSON.parse(e);if(n&&r.type){var i=a.Container.resolveType(r.type);return new i(n,{converters:void 0})}return n},"$data.Number":function(e){return JSON.parse(e)},"$data.Integer":function(e){return JSON.parse(e)},"$data.Int32":function(e){return JSON.parse(e)},"$data.Byte":function(e){return JSON.parse(e)},"$data.SByte":function(e){return JSON.parse(e)},"$data.Decimal":function(e){return"string"==typeof e&&e.toLowerCase().lastIndexOf("m")===e.length-1?e.substr(0,e.length-1):e},"$data.Float":function(e){return"string"==typeof e&&e.toLowerCase().lastIndexOf("f")===e.length-1?e.substr(0,e.length-1):e},"$data.Int16":function(e){return JSON.parse(e)},"$data.Int64":function(e){return e},"$data.Boolean":function(e){return JSON.parse(e)},"$data.Date":function(e){return"string"==typeof e&&/^datetime'/.test(e)?e.slice(9,e.length-1):e},"$data.String":function(e){return"string"==typeof e&&0===e.indexOf("'")&&e.lastIndexOf("'")===e.length-1?e.slice(1,e.length-1):e},"$data.ObjectID":function(e){return"string"==typeof e&&0===e.indexOf("'")&&e.lastIndexOf("'")===e.length-1?e.slice(1,e.length-1):e},"$data.Guid":function(e){if(/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/.test(e)){var t=e.slice(5,e.length-1);return n["default"].parseGuid(t).toString()}return e},"$data.Array":function(e,t){var r=t||{},i=JSON.parse(e)||[];if(i&&r.elementType){var o=a.Container.resolveType(r.elementType),s=a.Container.resolveName(o);if(o&&o.isAssignableTo&&o.isAssignableTo(n["default"].Entity)&&(s=n["default"].Entity.fullName),Array.isArray(i))for(var d=n["default"].oDataConverter.unescape[s],u=0;u<i.length;u++)i[u]=d?d(i[u]):i[u];return i}return i},"$data.DateTimeOffset":function(e){return"string"==typeof e?n["default"].Container.convertTo(e,n["default"].DateTimeOffset):e},"$data.Time":function(e){return"string"==typeof e&&/^time'/.test(e)?n["default"].Container.convertTo(e.slice(5,e.length-1),n["default"].Time):e},"$data.Day":function(e){return"string"==typeof e&&/^date'/.test(e)?n["default"].Container.convertTo(e.slice(5,e.length-1),n["default"].Day):e},"$data.Duration":function(e){return"string"==typeof e&&/^duration'/.test(e)?n["default"].Container.convertTo(e.slice(9,e.length-1),n["default"].Duration):e},"$data.Blob":function(e){if("string"==typeof e){if(/^X'/.test(e))return n["default"].Blob.createFromHexString(e.slice(2,e.length-1));if(/^binary'/.test(e))return n["default"].Blob.createFromHexString(e.slice(7,e.length-1))}return e},"$data.Object":function(e){return JSON.parse(e)},"$data.GeographyPoint":function(e){if(/^geography'POINT\(/i.test(e)){var t=e.slice(10,e.length-1);return n["default"].GeographyBase.parseFromString(t)}return e},"$data.GeographyPolygon":function(e){if(/^geography'POLYGON\(/i.test(e)){var t=e.slice(10,e.length-1);return n["default"].GeographyBase.parseFromString(t)}return e},"$data.GeometryPoint":function(e){if(/^geometry'POINT\(/i.test(e)){var t=e.slice(9,e.length-1);return n["default"].GeometryBase.parseFromString(t)}return e},"$data.GeometryPolygon":function(e){if(/^geometry'POLYGON\(/i.test(e)){var t=e.slice(9,e.length-1);return n["default"].GeometryBase.parseFromString(t)}return e}},xmlEscape:{"$data.Byte":function(e){return e.toString()},"$data.SByte":function(e){return e.toString()},"$data.Decimal":function(e){return e.toString()},"$data.Float":function(e){return e.toString()},"$data.Int16":function(e){return e.toString()},"$data.Int64":function(e){return e.toString()},"$data.Integer":function(e){return e.toString()},"$data.Int32":function(e){return e.toString()},"$data.Boolean":function(e){return e.toString()},"$data.Blob":function(e){return n["default"].Blob.toBase64(e)},"$data.Date":function(e){return e.toISOString().replace("Z","")},"$data.DateTimeOffset":function(e){return e.toISOString()},"$data.Time":function(e){return e.toString()},"$data.Day":function(e){return e.toString()},"$data.Duration":function(e){return e.toString()},"$data.Number":function(e){return e.toString()},"$data.String":function(e){return e.toString()},"$data.ObjectID":function(e){return e.toString()},"$data.Object":function(e){return JSON.stringify(e)},"$data.Guid":function(e){return e.toString()}},simple:{"$data.Byte":function(e){return e.toString()},"$data.SByte":function(e){return e.toString()},"$data.Decimal":function(e){return e.toString()},"$data.Float":function(e){return e.toString()},"$data.Int16":function(e){return e.toString()},"$data.Int64":function(e){return e.toString()},"$data.ObjectID":function(e){return e.toString()},"$data.Integer":function(e){return e.toString()},"$data.Int32":function(e){return e.toString()},"$data.Number":function(e){return e.toString()},"$data.Date":function(e){return e instanceof n["default"].Date?e.toISOString().replace("Z",""):e.toString()},"$data.DateTimeOffset":function(e){return e?e.toISOString():e},"$data.Time":function(e){return e.toString()},"$data.Day":function(e){return e.toString()},"$data.Duration":function(e){return e.toString()},"$data.String":function(e){return e.toString()},"$data.Boolean":function(e){return e.toString()},"$data.Blob":function(e){return e},"$data.Object":function(e){return JSON.stringify(e)},"$data.Array":function(e){return JSON.stringify(e)},"$data.Guid":function(e){return e.toString()},"$data.GeographyPoint":function(e){return JSON.stringify(e)},"$data.GeometryPoint":function(e){return JSON.stringify(e)},"$data.GeographyLineString":function(e){return JSON.stringify(e)},"$data.GeographyPolygon":function(e){return JSON.stringify(e)},"$data.GeographyMultiPoint":function(e){return JSON.stringify(e)},"$data.GeographyMultiLineString":function(e){return JSON.stringify(e)},"$data.GeographyMultiPolygon":function(e){return JSON.stringify(e)},"$data.GeographyCollection":function(e){return JSON.stringify(e)},"$data.GeometryLineString":function(e){return JSON.stringify(e)},"$data.GeometryPolygon":function(e){return JSON.stringify(e)},"$data.GeometryMultiPoint":function(e){return JSON.stringify(e)},"$data.GeometryMultiLineString":function(e){return JSON.stringify(e)},"$data.GeometryMultiPolygon":function(e){return JSON.stringify(e)},"$data.GeometryCollection":function(e){return JSON.stringify(e)}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"jaydata/core":"jaydata/core"}],7:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ODataIncludeFragment=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=e("jaydata/core"),s=a(o),d=r.ODataIncludeFragment=function(){function e(t){n(this,e),this.name=t,this.$expand=[],this.$operators=[]}return i(e,[{key:"toString",value:function(){var e="";if(this.$expand.length){this.name&&(e+=this.name+"($expand=");for(var t=0;t<this.$expand.length;t++)0!==t&&(e+=","),e+=this[this.$expand[t]].toString();this.name&&(e+=")")}if(this.name)for(var r=0;r<this.$operators.length;r++)for(var a=this.$operators[r],n=this[a],i=0;i<n.length;i++)e&&(e+=","),e+=this.name+"("+a+"=",e+=n[i],e+=")";return this.name&&!e&&(e=this.name),e}},{key:"addInclude",value:function(e,t){this._createIncludePath(e)}},{key:"addImplicitMap",value:function(e,t){var r=this._createIncludePath(e);this._setImplicitMap(r,t)}},{key:"_createIncludePath",value:function(t){if(!t)return this;for(var r=t.split("."),a=this,n=0;n<r.length;n++){var i=r[n],o=!0;a.$expand.indexOf(i)<0&&(o=!1,a.$expand.push(i),a[i]=new e(i),a[i].__implicit=!0),a=a[i],n<r.length-1&&a.__implicit&&this._setImplicitMap(a,r[n+1])}return a}},{key:"_setImplicitMap",value:function(e,t){t&&(e.$operators.indexOf("$select")<0?e.__implicit&&(e.$operators.push("$select"),e.$select=[t]):e.$expand.indexOf(t)<0&&(e.$select[0]+=","+t))}}]),e}();s["default"].storageProviders.oData.ODataIncludeFragment=d,(0,o.$C)("$data.storageProviders.oData.oDataIncludeCompiler",s["default"].Expressions.EntityExpressionVisitor,null,{constructor:function(e){this.provider=e},compile:function(e,t){t.data=t.data||new d,t.current=t.data,this.Visit(e,t)},VisitParametricQueryExpression:function(e,t){this.Visit(e.expression,t)},VisitEntitySetExpression:function(e,t){this.Visit(e.source,t),e.selector instanceof s["default"].Expressions.AssociationInfoExpression&&this.Visit(e.selector,t)},VisitAssociationInfoExpression:function(e,t){var r=e.associationInfo.FromPropertyName;this.includePath=this.includePath?this.includePath+".":"",this.includePath+=r;var a=this.includePath;t.includes.some(function(e){return e.name==a},this)||t.includes.push({name:a,type:e.associationInfo.ToType}),t.current.$expand.indexOf(r)<0&&(t.current.$expand.push(r),t.current[r]=new d(r)),t.current=t.current[r]},VisitFrameOperationExpression:function(e,t){this.Visit(e.source,t);var r=e.operation.memberDefinition;if(r&&r.includeFrameName){var a=r.includeFrameName,n=0,i=r.parameters||[{name:"@expression"}],d=i.map(function(t,r){return"@expression"===t.name?e.source:e.parameters[n++]});if(r.includeCompiler)for(var u=0;u<d.length;u++){var p=d[u],l=o.Container.resolveType(r.includeCompiler),f=new l(this.provider),c={data:"",$expand:t.current};if(p&&p.value instanceof s["default"].Queryable){var y=o.Container.createQueryExpressionCreator(p.value.entityContext),m=y.Visit(p.value.expression);p=m}f.compile(p,c);t.current.$operators.indexOf(a)<0&&(t.current[a]=[],t.current.$operators.push(a)),t.current[a].push(c[a]||c.data)}else r.implementation&&(t.current.$operators.indexOf(a)<0&&(t.current[a]=[],t.current.$operators.push(a)),t.current[a].push(r.implementation()))}}})},{"jaydata/core":"jaydata/core"}],8:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var n=e("jaydata/core"),i=a(n);(0,n.$C)("$data.storageProviders.oData.oDataOrderCompiler",i["default"].storageProviders.oData.oDataWhereCompiler,null,{constructor:function(e){this.provider=e},compile:function(e,t){this.Visit(e,t)},VisitOrderExpression:function(e,t){var r={data:""};this.Visit(e.selector,r),t.$orderby?t.$orderby+=",":t.$orderby="",t.$orderby+=r.data+(e.nodeType==i["default"].Expressions.ExpressionType.OrderByDescending?" desc":"")},VisitParametricQueryExpression:function(e,t){this.Visit(e.expression,t)},VisitEntityFieldExpression:function(e,t){this.Visit(e.source,t),this.Visit(e.selector,t)},VisitComplexTypeExpression:function(e,t){this.Visit(e.source,t),this.Visit(e.selector,t),t.data+="/"},VisitEntitySetExpression:function(e,t){e.selector instanceof i["default"].Expressions.AssociationInfoExpression&&(this.Visit(e.source,t),this.Visit(e.selector,t))},VisitAssociationInfoExpression:function(e,t){t.data+=e.associationInfo.FromPropertyName+"/"},VisitEntityExpression:function(e,t){this.Visit(e.source,t),this.Visit(e.selector,t)},VisitMemberInfoExpression:function(e,t){t.data+=e.memberName},VisitEntityFieldOperationExpression:function(e,t){n.Guard.requireType("expression.operation",e.operation,i["default"].Expressions.MemberInfoExpression);var r=e.operation.memberDefinition,a=r.mapTo||r.name;t.data+=a,t.data+="(";var o=0,s=r.parameters||[{name:"@expression"}],d=s.map(function(t,r){return"@expression"===t.name?e.source:e.parameters[o++]});d.forEach(function(e,r){r>0&&(t.data+=","),this.Visit(e,t)},this),t.data+=")"},VisitEntityFunctionOperationExpression:function(e,t){n.Guard.requireType("expression.operation",e.operation,i["default"].Expressions.MemberInfoExpression),this.Visit(e.source,t);var r=e.operation.memberDefinition,a=r.mapTo||r.name;t.data+=a,t.data+="(";var o=0,s=r.method.params||[{name:"@expression"}],d=s.map(function(t,r){return"@expression"===t.name?e.source:e.parameters[o++]}),u=0;d.forEach(function(e,r){void 0===e||e instanceof i["default"].Expressions.ConstantExpression&&"undefined"==typeof e.value||(u>0&&(t.data+=","),u++,t.data+=s[r].name+"=",this.Visit(e,t))},this),t.data+=")"},VisitContextFunctionOperationExpression:function(e,t){return this.VisitEntityFunctionOperationExpression(e,t)}})},{"jaydata/core":"jaydata/core"}],9:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var n=e("jaydata/core"),i=a(n);(0,n.$C)("$data.storageProviders.oData.oDataPagingCompiler",i["default"].Expressions.EntityExpressionVisitor,null,{constructor:function(e){this.provider=e},compile:function(e,t){this.Visit(e,t)},VisitPagingExpression:function(e,t){var r={data:""};switch(this.Visit(e.amount,r),e.nodeType){case i["default"].Expressions.ExpressionType.Skip:t.$skip=r.data;break;case i["default"].Expressions.ExpressionType.Take:t.$top=r.data;break;default:n.Guard.raise("Not supported nodeType")}},VisitConstantExpression:function(e,t){var r=n.Container.resolveName(e.type),a=this.provider.fieldConverter.escape[r];t.data+=a?a(e.value):e.value}})},{"jaydata/core":"jaydata/core"}],10:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var n=e("jaydata/core"),i=a(n);(0,n.$C)("$data.storageProviders.oData.oDataProjectionCompiler",i["default"].Expressions.EntityExpressionVisitor,null,{constructor:function(e){this.provider=e,this.entityContext=e.context,this.hasObjectLiteral=!1,this.modelBinderMapping=[]},compile:function(e,t){this.Visit(e,t)},VisitProjectionExpression:function(e,t){t.data="",this.mapping="",this.Visit(e.selector,t),t.$select?t.$select+=",":t.$select="",t.$select+=t.data,t.data=""},VisitParametricQueryExpression:function(e,t){this.Visit(e.expression,t);var r=this.mapping.split(".");e.expression instanceof i["default"].Expressions.EntityExpression||e.expression instanceof i["default"].Expressions.EntitySetExpression||r.pop(),r.length>0&&(t.$expand&&t.$expand instanceof i["default"].storageProviders.oData.ODataIncludeFragment||(t.$expand=new i["default"].storageProviders.oData.ODataIncludeFragment),
t.$expand.addInclude(r.join(".")))},VisitObjectLiteralExpression:function(e,t){this.hasObjectLiteral=!0,e.members.forEach(function(r,a){this.Visit(r,t),a<e.members.length-1&&(t.data+=","),this.mapping=""},this)},VisitObjectFieldExpression:function(e,t){this.Visit(e.expression,t);var r=this.mapping.split("."),a="";if(e.expression instanceof i["default"].Expressions.EntityExpression||e.expression instanceof i["default"].Expressions.EntitySetExpression||(a=r.pop()),r.length>0){if(t.$expand&&t.$expand instanceof i["default"].storageProviders.oData.ODataIncludeFragment||(t.$expand=new i["default"].storageProviders.oData.ODataIncludeFragment),e.expression instanceof i["default"].Expressions.EntityFieldExpression&&e.expression.selector instanceof i["default"].Expressions.MemberInfoExpression){var n=this.entityContext._storageModel.getStorageModel(e.expression.selector.memberDefinition.definedBy);if(!n)return;var o=n&&!!n.ComplexTypes[e.memberName];if(o){var s=r.pop();return void t.$expand.addImplicitMap(r.join("."),s)}}e.expression instanceof i["default"].Expressions.ComplexTypeExpression?t.$expand.addImplicitMap(r.join("."),a):t.$expand.addInclude(r.join("."))}},VisitComplexTypeExpression:function(e,t){this.Visit(e.source,t),this.Visit(e.selector,t)},VisitEntityFieldExpression:function(e,t){this.Visit(e.source,t),this.Visit(e.selector,t)},VisitEntityExpression:function(e,t){this.Visit(e.source,t)},VisitEntitySetExpression:function(e,t){e.source instanceof i["default"].Expressions.EntityExpression&&this.Visit(e.source,t),e.selector instanceof i["default"].Expressions.AssociationInfoExpression&&this.Visit(e.selector,t)},VisitAssociationInfoExpression:function(e,t){this.mapping&&this.mapping.length>0&&(this.mapping+="."),this.mapping+=e.associationInfo.FromPropertyName,t.data&&t.data.length>0&&","!=t.data[t.data.length-1]?(t.$expand&&t.$expand instanceof i["default"].storageProviders.oData.ODataIncludeFragment||(t.$expand=new i["default"].storageProviders.oData.ODataIncludeFragment),t.$expand.addInclude(this.mapping)):t.data+=e.associationInfo.FromPropertyName},VisitMemberInfoExpression:function(e,t){var r=this.entityContext._storageModel.getStorageModel(e.memberDefinition.definedBy),a=r&&!!r.ComplexTypes[e.memberName],n=!r;if(t.data&&t.data.length>0&&","!=t.data[t.data.length-1]){if(this.mapping)if(t.$expand&&t.$expand instanceof i["default"].storageProviders.oData.ODataIncludeFragment||(t.$expand=new i["default"].storageProviders.oData.ODataIncludeFragment),n){var o=this.mapping.split("."),s=o.pop();this.provider.checkODataMode("disableCompltexTypeMapping")?t.$expand.addImplicitMap(o.join("."),s):t.$expand.addImplicitMap(o.join("."),s+"/"+e.memberName)}else a||t.$expand.addImplicitMap(this.mapping,e.memberName)}else t.data+=e.memberName;this.mapping&&this.mapping.length>0&&(this.mapping+="."),this.mapping+=e.memberName},VisitConstantExpression:function(e,t){t.data=t.data.slice(0,t.data.length-1)}})},{"jaydata/core":"jaydata/core"}],11:[function(e,t,r){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=e("jaydata/core"),s=n(o),d=e("./oDataRequestActivities.js"),u=a(d),p=e("./SaveStrategies/empty"),l=e("./SaveStrategies/single"),f=e("./SaveStrategies/batch");s["default"].defaults=s["default"].defaults||{},s["default"].defaults.OData=s["default"].defaults.OData||{},"withReferenceMethods"in s["default"].defaults.OData||(s["default"].defaults.OData.withReferenceMethods=!1),"disableBatch"in s["default"].defaults.OData||(s["default"].defaults.OData.disableBatch=!1),"eTagAny"in s["default"].defaults.OData||(s["default"].defaults.OData.eTagAny="*"),"enableDeepSave"in s["default"].defaults.OData||(s["default"].defaults.OData.enableDeepSave=!1),"disableCompltexTypeMapping"in s["default"].defaults.OData||(s["default"].defaults.OData.disableCompltexTypeMapping=!1);var c=function(e,t){return"undefined"!=typeof e.providerConfiguration[t]?!!e.providerConfiguration[t]:!!s["default"].defaults.OData[t]};(0,o.$C)("$data.storageProviders.oData.RequestManager",s["default"].Base,null,{constructor:function(){this._items=[],this._entities=[]},_items:{type:s["default"].Array},_entities:{type:s["default"].Array},add:function(e,t,r){var a={data:e,entity:e.data,request:t,itemIndex:++this.maxItemIndex,references:[]};return t.add(new u.SetHeaderProperty("content-Id",a.itemIndex)),r!==!1&&this.length++,this._entities.push(a.entity),this._items.push(a),a},addItemReference:function(e,t){var r=this.getItem(e);r&&r.references.push(t)},getItemIndex:function(e){if(!e)return-1;var t=this._entities.indexOf(e);return t>=0&&!this._items[t].removed?this._items[t].itemIndex:-1},getItem:function(e,t){if(!e)return null;var r=this._entities.indexOf(e);return!(r>=0)||t&&this._items[r].removed?null:this._items[r]},remove:function(e){var t=this._entities.indexOf(e);if(t>=0){var r=this._items[t];if(!r.removed)return this._items[t].removed=!0,this.length--,!0}return!1},getItems:function(){return this._items.filter(function(e){return!e.removed})},getByResponse:function(e,t){var r=t;this._indexCalculated||(this._indexCalculated=!0,this._dataForResult=this._items.filter(function(e){return!e.removed}));var a=this._dataForResult[r++];return a?a.entity:null},setProcessed:function(e){var t=this._entities.indexOf(e);if(t>=0){var r=this._items[t];if(!r.isProcessed)return this._items[t].isProcessed=!0,!0}return!1},maxItemIndex:{value:0},length:{value:0}}),(0,o.$C)("$data.storageProviders.oData.oDataProvider",s["default"].StorageProviderBase,null,{constructor:function(e,t){this.SqlCommands=[],this.context=t,this.providerConfiguration=s["default"].typeSystem.extend({dbCreation:s["default"].storageProviders.DbCreationType.DropTableIfChanged,oDataServiceHost:"/odata.svc",serviceUrl:"",maxDataServiceVersion:"4.0",dataServiceVersion:void 0,user:null,password:null,withCredentials:!1,UpdateMethod:"PATCH"},e),"undefined"==typeof s["default"].odatajs||"undefined"==typeof s["default"].odatajs.oData?"undefined"==typeof odatajs||"undefined"==typeof odatajs.oData?o.Guard.raise(new o.Exception("odatajs is required","Not Found!")):this.oData=odatajs.oData:this.oData=s["default"].odatajs.oData,this.context&&this.context._buildDbType_generateConvertToFunction&&this.buildDbType_generateConvertToFunction&&(this.context._buildDbType_generateConvertToFunction=this.buildDbType_generateConvertToFunction),this.context&&this.context._buildDbType_modifyInstanceDefinition&&this.buildDbType_modifyInstanceDefinition&&(this.context._buildDbType_modifyInstanceDefinition=this.buildDbType_modifyInstanceDefinition)},fixkDataServiceVersions:function(e){this.providerConfiguration.dataServiceVersion>this.providerConfiguration.maxDataServiceVersion&&(this.providerConfiguration.dataServiceVersion=this.providerConfiguration.maxDataServiceVersion),this.providerConfiguration.setDataServiceVersionToMax===!0&&(this.providerConfiguration.dataServiceVersion=this.providerConfiguration.maxDataServiceVersion),(e&&!e.UpdateMethod&&this.providerConfiguration.dataServiceVersion<"3.0"||!this.providerConfiguration.dataServiceVersion)&&(this.providerConfiguration.UpdateMethod="MERGE")},initializeStore:function(e){switch(e=s["default"].PromiseHandlerBase.createCallbackSettings(e),this.providerConfiguration.dbCreation){case s["default"].storageProviders.DbCreationType.DropAllExistingTables:var t=this;if(this.providerConfiguration.serviceUrl){var r=[{requestUri:t.providerConfiguration.serviceUrl+"/Delete",method:"POST"},function(r){e.success(t.context)},function(r){e.success(t.context)}];this.appendBasicAuth(r[0],this.providerConfiguration.user,this.providerConfiguration.password,this.providerConfiguration.withCredentials),this.context.prepareRequest.call(this,r),this.oData.request.apply(this,r)}else e.success(t.context);break;default:e.success(this.context)}},buildDbType_generateConvertToFunction:function(e,t){return function(r,a){var n=new e.PhysicalType;return n.entityState=r.entityState,e.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(e){n.initData[e.name]=r[e.name]},this),e.Associations&&e.Associations.forEach(function(e){if("*"==e.FromMultiplicity&&"0..1"==e.ToMultiplicity||"0..1"==e.FromMultiplicity&&"1"==e.ToMultiplicity||"$$unbound"==e.FromMultiplicity){var i=r[e.FromPropertyName];if(void 0!==i)if(i instanceof s["default"].Array)n.initData[e.FromPropertyName]=n[e.FromPropertyName]||[],i.forEach(function(r){var i=a.getItem(r,!0),d=i?i.itemIndex:-1;if(r.entityState==s["default"].EntityState.Modified||0>d){var u=t._storageModel.getStorageModel(r.getType()),p=u.TableName,l="("+t.storageProvider.getEntityKeysValue({data:r,entitySet:t.getEntitySetFromElementType(r.getType())})+")";n.initData[e.FromPropertyName].push({__metadata:{uri:p+l}})}else 0>d&&o.Guard.raise("Dependency graph error"),n.initData[e.FromPropertyName].push({__convertedRefence:i})},this);else if(null===i)n.initData[e.FromPropertyName]=null;else{var d=a.getItem(i,!0),u=d?d.itemIndex:-1;if(i.entityState==s["default"].EntityState.Modified||0>u){var p=t._storageModel.getStorageModel(i.getType()),l=p.TableName,f="("+t.storageProvider.getEntityKeysValue({data:i,entitySet:t.getEntitySetFromElementType(i.getType())})+")";n.initData[e.FromPropertyName]={__metadata:{uri:l+f}}}else 0>u&&o.Guard.raise("Dependency graph error"),n.initData[e.FromPropertyName]={__convertedRefence:d}}}},this),e.ComplexTypes&&e.ComplexTypes.forEach(function(e){n.initData[e.FromPropertyName]=r[e.FromPropertyName]},this),n}},buildDbType_modifyInstanceDefinition:function(){},executeQuery:function(e,t){t=s["default"].PromiseHandlerBase.createCallbackSettings(t);var r={};try{r=this._compile(e)}catch(a){return void t.error(a)}var n=(this.context,this),d="@odata.count",u=[{requestUri:this.providerConfiguration.oDataServiceHost+r.queryText,method:r.method,data:r.postData,headers:{}},function(a,u,p){if(a||!u.body||r.isBatchExecuteQuery||(a=JSON.parse(u.body)),t.success){var l=function(e,t,r){e.rawDataList="string"==typeof t?[{cnt:o.Container.convertTo(t,s["default"].Integer)}]:t,r.withInlineCount&&"object"===("undefined"==typeof t?"undefined":i(t))&&("undefined"!=typeof t[d]||"d"in t&&"undefined"!=typeof t.d[d])&&(e.__count=new Number("undefined"!=typeof t[d]?t[d]:t.d[d]).valueOf())};if(r.isBatchExecuteQuery){e.rawDataList=r.subQueries;for(var f=0;f<a.__batchResponses.length;f++){var c=a.__batchResponses[f];if(!c.data){if(!c.body)return void t.error(n.parseError(c,arguments));c.data=JSON.parse(c.body)}l(r.subQueries[f],c.data,r.subQueries[f]._getComplitedData())}}else l(e,a,r);t.success(e)}},function(e){t.error(n.parseError(e,arguments))},r.isBatchExecuteQuery?this.oData.batch.batchHandler:void 0];"undefined"!=typeof this.providerConfiguration.enableJSONP&&(u[0].enableJsonpCallback=this.providerConfiguration.enableJSONP),"undefined"!=typeof this.providerConfiguration.useJsonLight&&(u[0].useJsonLight=this.providerConfiguration.useJsonLight),this.appendBasicAuth(u[0],this.providerConfiguration.user,this.providerConfiguration.password,this.providerConfiguration.withCredentials),this.context.prepareRequest.call(this,u),this.oData.request.apply(this,u)},_compile:function(e,t){var r=new s["default"].storageProviders.oData.oDataCompiler,a=r.compile(e);return a},saveChanges:function(e,t){t.length>0?this.saveInternal(t,e):e.success(0)},saveInternal:function(e,t){var r=this.buildIndependentBlocks(e);c(this,"enableDeepSave")&&this._checkDeepSave(e);var a=this._buildSaveData(r,e),n=this.saveStrategySelector(a);n?n.save(this,a,t):t.error(new o.Exception("Not Found","Save action not found"))},saveStrategySelector:function(e){for(var t=0;t<this.saveStrategies.length;t++){var r=this.saveStrategies[t];if(r.condition(this,e))return r}return null},saveStrategies:{value:[f.strategy,l.strategy,p.strategy]},_discoverSaveOrder:function(e){for(var t=e.map(function(e){return e.data}),r=e.map(function(e){return{path:[],visited:!1,result:!0}}),a=[],n=[],i=function(i){var o=t.indexOf(i),s=e[o],d=r[o];if(d.visited)return d.result;if(d.visiting)return!1;var u=[];s.referredBy&&(u=u.concat(s.referredBy)),s.dependentOn&&(u=u.concat(s.dependentOn));for(var p=0;p<u.length;p++){var l=u[p];if(n.indexOf(l)<0){a.push(l),n.push(l);var f=t.indexOf(l);e[f].deepParent=i}}},o=0;o<e.length;o++){var s=e[o];for(a.indexOf(s.data)<0&&(a.push(s.data),n.push(s.data),r[o].parent=null);a.length;){var d=a.shift();i(d)}}},_checkDeepSave:function(e){for(var t=e.map(function(e){return e.data}),r=e.map(function(e){return{path:[],visited:!1,result:!0}}),a=function o(a,n,i){var d=r[i];if(d.visited)return d.result;if(d.visiting)return!1;var u=[];if(a.referredBy&&(u=u.concat(a.referredBy)),a.dependentOn&&(u=u.concat(a.dependentOn)),0===u.length)d.visited=!0,d.result=!0;else{d.visiting=!0;for(var p=0;p<u.length;p++){var l=u[p],f=t.indexOf(l),c=e[f];if(!c)return!1;if(c!==n){var y=o(c,a,f);d.result=d.result&&a.data.entityState===s["default"].EntityState.Added&&(!a.additionalDependentOn||0===a.additionalDependentOn.length)&&y}}delete d.visiting,d.visited=!0}return a.enableDeepSave=d.result,d.result},n=0;n<e.length;n++){var i=e[n];a(i,null,n)}this._discoverSaveOrder(e)},_buildSaveData:function(e,t){for(var r=new s["default"].storageProviders.oData.RequestManager,a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++){var i=e[a][n],d=null,p=r.getItem(i.data);p||(d=new u.RequestBuilder(this),d.add(new u.SetUrl(this.providerConfiguration.oDataServiceHost+"/")),p=r.add(i,d)),d=p.request;var l=i.data.entityState;"function"==typeof this._buildRequestObject["EntityState_"+l]?this._buildRequestObject["EntityState_"+l](this,i,r,d,t):o.Guard.raise(new o.Exception("Not supported Entity state"))}return r},_buildRequestObject:{value:{EntityState_20:function(e,t,r,a,n){a.add(new u.SetMethod("POST"),new u.AppendUrl(t.entitySet.tableName)),e.save_getInitData(t,r,void 0,void 0,a,n)},EntityState_30:function(e,t,r,a,n){a.add(new u.SetMethod(e.providerConfiguration.UpdateMethod),new u.AppendUrl(t.entitySet.tableName),new u.AppendUrl("("+e.getEntityKeysValue(t)+")")),e.addETagHeader(t,a),e.save_getInitData(t,r,void 0,void 0,a,n)},EntityState_40:function(e,t,r,a,n){a.add(new u.SetMethod("DELETE"),new u.ClearRequestData,new u.AppendUrl(t.entitySet.tableName),new u.AppendUrl("("+e.getEntityKeysValue(t)+")")),e.addETagHeader(t,a)}}},reload_fromResponse:function(e,t,r){var a=this;e.getType().memberDefinitions.getPublicMappedProperties().forEach(function(r){var n=o.Container.resolveType(r.type);if(r.computed||r.key||!r.inverseProperty)if(r.concurrencyMode===s["default"].ConcurrencyMode.Fixed)e[r.name]=t["@odata.etag"];else if(r.isAssignableTo)t[r.name]?e[r.name]=new n(t[r.name],{converters:a.fieldConverter.fromDb}):e[r.name]=t[r.name];else if(n===s["default"].Array&&r.elementType){var i=o.Container.resolveType(r.elementType);if(t[r.name]&&Array.isArray(t[r.name])){for(var d=[],u=0;u<t[r.name].length;u++){var p=t[r.name][u];if(i.isAssignableTo&&!o.Guard.isNullOrUndefined(p))d.push(new i(p,{converters:a.fieldConverter.fromDb}));else{var l=o.Container.resolveName(i),f=a.fieldConverter.fromDb[l];d.push(f?f(p):p)}}e[r.name]=d}else t[r.name]||(e[r.name]=t[r.name])}else{var c=o.Container.resolveName(r.type),y=a.fieldConverter.fromDb[c];e[r.name]=y?y(t[r.name]):t[r.name]}},this)},save_getInitData:function(e,t,r,a,n,i){var o=this;r?e.physicalData=e.data:e.physicalData=this.context._storageModel.getStorageModel(e.data.getType()).PhysicalType.convertTo(e.data,t);var d=e.data.entityState===s["default"].EntityState.Added;e.physicalData.getType().memberDefinitions.asArray().forEach(function(r){d=o.propertyConversationSelector(e,r,t,n,i,a)||d},this),d||a||t.remove(e.data)},propertyConversationSelector:function(e,t,r,a,n,i){return t.kind==s["default"].MemberTypes.complexProperty?this._complexPropertySelector.apply(this,arguments):t.kind==s["default"].MemberTypes.property?this._propertySelector.apply(this,arguments):t.kind==s["default"].MemberTypes.navProperty?this._navigationPropertySelector.apply(this,arguments):!1},_complexPropertySelector:function(e,t,r,a,n,i){return this.propertyConversationStrategies.complex.apply(this,arguments)},_propertySelector:function(e,t,r,a,n,i){if("undefined"==typeof t.concurrencyMode)switch(!0){case t.notMapped:return!1;case t.key===!0:return this.propertyConversationStrategies["default"].apply(this,arguments),!1;case i:case e.data.entityState===s["default"].EntityState.Added:case this._propertyIsChanged(e.data,t):return this.propertyConversationStrategies["default"].apply(this,arguments);default:return!1}return!1},_navigationPropertySelector:function(e,t,r,a,n,i){var o=this;if(i||e.data.entityState===s["default"].EntityState.Added||this._propertyIsChanged(e.data,t)){var d=e.data[t.name];if(c(this,"enableDeepSave")&&d&&e.data.entityState===s["default"].EntityState.Added){var u=null;if(Array.isArray(d))return d.forEach(function(i,s){o._processDeepSaveItems(e,t,r,a,n,i,"deepSaveArray",s)}),!0;if(u=this._processDeepSaveItems(e,t,r,a,n,d,"deepSave"),null!==u)return u}return this._simpleNavigationPropertySelector.apply(this,arguments)}return!1},_simpleNavigationPropertySelector:function(e,t,r,a,n,i){return c(this,"withReferenceMethods")?this.propertyConversationStrategies.withReferenceMethods.apply(this,arguments):this.propertyConversationStrategies.navigation.apply(this,arguments)},_processDeepSaveItems:function(e,t,r,a,n,i,o,d){var p=n.filter(function(e){return e.data==i});if(1===p.length&&p[0].enableDeepSave&&i.entityState===s["default"].EntityState.Added&&p[0].deepParent===e.data){var l=r.getItem(p[0].data);if(!l){var f=new u.RequestBuilder(this);f.add(new u.SetUrl(this.providerConfiguration.oDataServiceHost+"/")),l=r.add(p[0],f)}return r.addItemReference(e.data,l),l.removed||r.remove(p[0].data),this.propertyConversationStrategies[o].call(this,e,t,r,a,n,d)}return null},_propertyIsChanged:function(e,t){return e&&e.changedProperties&&e.changedProperties.some(function(e){return e.name===t.name})},propertyConversationStrategies:{value:{"default":function(e,t,r,a,n){var i=o.Container.resolveName(t.type),s=this.fieldConverter.toDb[i];return a.add(new u.SetProperty(t.name,s?s(e.physicalData[t.name]):e.physicalData[t.name])),!0},withReferenceMethods:function(e,t,r,a,n){var i=r.getItem(e.data);if(i&&i.removed)return!1;var o=new u.RequestBuilder(this),d=e.physicalData[t.name];if(d)o.add(new u.SetMethod("POST")),d.__metadata?o.add(new u.SetProperty("@odata.id",this.providerConfiguration.oDataServiceHost+"/"+d.__metadata.uri)):d.__convertedRefence&&o.add(function(e,t){var r=d.__convertedRefence;e.data=e.data||{},r.isProcessed?e.data["@odata.id"]=t.getEntityUrlReference(r.entity):e.data["@odata.id"]=t.providerConfiguration.oDataServiceHost+"/$"+r.itemIndex});else{if(e.data.entityState===s["default"].EntityState.Added||null!==d)return;o.add(new u.SetUrl(this.providerConfiguration.oDataServiceHost+"/"),new u.AppendUrl(e.entitySet.tableName),new u.AppendUrl("("+this.getEntityKeysValue(e)+")"),new u.SetMethod("DELETE"),new u.ClearRequestData)}o.add(function(r,a){i.isProcessed||e.data.entityState!==s["default"].EntityState.Added?(r.requestUri=a.providerConfiguration.oDataServiceHost+"/",r.requestUri+=e.entitySet.tableName,r.requestUri+="("+a.getEntityKeysValue(e)+")",a.addETagHeader(e,r)):(r.requestUri="$"+i.itemIndex,a.addETagHeader(e,r,s["default"].defaults.OData.eTagAny)),r.requestUri+="/"+t.name+"/$ref"});var p=r.add(e,o,!1);return r.addItemReference(e.data,p),!1},deepSave:function(e,t,r,a,n){var i=r.getItem(e.data[t.name]);return a.add(function(e,r){e.data[t.name]=i.request.build().get().data}),!0},deepSaveArray:function(e,t,r,a,n,i){var o=r.getItem(e.data[t.name][i]);return a.add(function(e,r){e.data[t.name]=e.data[t.name]||[],e.data[t.name].push(o.request.build().get().data)}),!0},navigation:function(e,t,r,a,n){return a.add(function(r,a){if(r.data=r.data||{},e.physicalData[t.name]&&e.physicalData[t.name].__metadata)r.data[t.name+"@odata.bind"]=e.physicalData[t.name].__metadata.uri;else if(e.physicalData[t.name]&&e.physicalData[t.name].__convertedRefence){var n=e.physicalData[t.name].__convertedRefence;n.isProcessed?r.data[t.name+"@odata.bind"]=a.getEntityUrlReference(n.entity):r.data[t.name+"@odata.bind"]="$"+n.itemIndex}else null===e.physicalData[t.name]&&(r.data[t.name+"@odata.bind"]=null)}),!0},complex:function(e,t,r,a,n){if(e.physicalData[t.name]){var i=new u.RequestBuilder(this);return this.save_getInitData({data:e.physicalData[t.name]},r,!0,!0,i),a.add(function(e){e.data=e.data||{},e.data[t.name]=i.build().get().data}),!0}return!1}}},addETagHeader:function(e,t,r){var a=e.data.getType().memberDefinitions.getPublicMappedProperties().filter(function(e){return e.concurrencyMode===s["default"].ConcurrencyMode.Fixed});if(a&&a[0]){var n="undefined"!=typeof r?r:e.data[a[0].name];"undefined"!=typeof n&&(t instanceof u.RequestBuilder?t.add(new u.SetHeaderProperty("If-Match",n)):t.headers["If-Match"]=n)}},getTraceString:function(e){this._compile(e);return e},supportedDataTypes:{value:[s["default"].Array,s["default"].Integer,s["default"].String,s["default"].Number,s["default"].Blob,s["default"].Boolean,s["default"].Date,s["default"].Object,s["default"].GeographyPoint,s["default"].Guid,s["default"].GeographyLineString,s["default"].GeographyPolygon,s["default"].GeographyMultiPoint,s["default"].GeographyMultiLineString,s["default"].GeographyMultiPolygon,s["default"].GeographyCollection,s["default"].GeometryPoint,s["default"].GeometryLineString,s["default"].GeometryPolygon,s["default"].GeometryMultiPoint,s["default"].GeometryMultiLineString,s["default"].GeometryMultiPolygon,s["default"].GeometryCollection,s["default"].Byte,s["default"].SByte,s["default"].Decimal,s["default"].Float,s["default"].Int16,s["default"].Int32,s["default"].Int64,s["default"].Time,s["default"].Day,s["default"].DateTimeOffset,s["default"].Duration],writable:!1},supportedBinaryOperators:{value:{equal:{mapTo:"eq",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},notEqual:{mapTo:"ne",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},equalTyped:{mapTo:"eq",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},notEqualTyped:{mapTo:"ne",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},greaterThan:{mapTo:"gt",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},greaterThanOrEqual:{mapTo:"ge",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},lessThan:{mapTo:"lt",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},lessThenOrEqual:{mapTo:"le",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},or:{mapTo:"or",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},and:{mapTo:"and",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},add:{mapTo:"add",dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},divide:{mapTo:"div",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},multiply:{mapTo:"mul",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},subtract:{mapTo:"sub",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},modulo:{mapTo:"mod",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]},"in":{mapTo:"in",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression]}}},supportedUnaryOperators:{value:{not:{mapTo:"not"}}},supportedFieldOperations:{value:{contains:{mapTo:"contains",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression"},{name:"substring",dataType:"string"}]},startsWith:{mapTo:"startswith",dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},endsWith:{mapTo:"endswith",dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},length:[{allowedType:"string",dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.ProjectionExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"}]},{allowedType:"GeographyLineString",mapTo:"geo.length",dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:["GeographyLineString"]}],fixedDataType:"decimal"},{allowedType:"GeometryLineString",mapTo:"geo.length",dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"GeometryLineString"}],fixedDataType:"decimal"}],strLength:{mapTo:"length",dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.ProjectionExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"}]},indexOf:{dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],mapTo:"indexof",baseIndex:1,parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},replace:{dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"},{name:"strFrom",dataType:"string"},{name:"strTo",dataType:"string"}]},substr:{mapTo:"substring",dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"},{name:"startFrom",dataType:"number"},{name:"length",dataType:"number",optional:"true"}]},toLowerCase:{mapTo:"tolower",dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"}]},toUpperCase:{mapTo:"toupper",dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"}]},trim:{dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"}]},concat:{dataType:"string",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},day:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},hour:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},minute:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},month:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},second:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},year:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},round:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},floor:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"}]},ceiling:{allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"date"
}]},distance:[{allowedType:"GeographyPoint",mapTo:"geo.distance",dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"GeographyPoint"},{name:"to",dataType:"GeographyPoint"}],fixedDataType:"decimal"},{allowedType:"GeometryPoint",mapTo:"geo.distance",dataType:"number",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"GeometryPoint"},{name:"to",dataType:"GeometryPoint"}],fixedDataType:"decimal"}],intersects:[{allowedType:"GeographyPoint",mapTo:"geo.intersects",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"GeographyPoint"},{name:"in",dataType:"GeographyPolygon"}]},{allowedType:"GeometryPoint",mapTo:"geo.intersects",dataType:"boolean",allowedIn:[s["default"].Expressions.FilterExpression,s["default"].Expressions.OrderExpression,s["default"].Expressions.SomeExpression,s["default"].Expressions.EveryExpression],parameters:[{name:"@expression",dataType:"GeometryPoint"},{name:"in",dataType:"GeometryPolygon"}]}]},enumerable:!0,writable:!0},supportedSetOperations:{value:{filter:{allowedIn:[s["default"].Expressions.IncludeExpression],parameters:[{name:"filter",dataType:"$data.Queryable"}],frameType:s["default"].Expressions.FilterExpression,includeFrameName:"$filter",includeCompiler:"$data.storageProviders.oData.oDataWhereCompiler"},map:{allowedIn:[s["default"].Expressions.IncludeExpression],parameters:[{name:"map",dataType:"$data.Queryable"}],frameType:s["default"].Expressions.ProjectionExpression,includeFrameName:"$select",includeCompiler:"$data.storageProviders.oData.oDataProjectionCompiler"},length:{},forEach:{},toArray:{},single:{},some:{invokable:!1,allowedIn:[s["default"].Expressions.FilterExpression],parameters:[{name:"some",dataType:"$data.Queryable"}],mapTo:"any",frameType:s["default"].Expressions.SomeExpression},every:{invokable:!1,allowedIn:[s["default"].Expressions.FilterExpression],parameters:[{name:"every",dataType:"$data.Queryable"}],mapTo:"all",frameType:s["default"].Expressions.EveryExpression},take:{allowedIn:[s["default"].Expressions.IncludeExpression],parameters:[{name:"take",dataType:"$data.Integer"}],frameType:s["default"].Expressions.PagingExpression,includeFrameName:"$top",includeCompiler:"$data.storageProviders.oData.oDataPagingCompiler"},skip:{allowedIn:[s["default"].Expressions.IncludeExpression],parameters:[{name:"skip",dataType:"$data.Integer"}],frameType:s["default"].Expressions.PagingExpression,includeFrameName:"$skip",includeCompiler:"$data.storageProviders.oData.oDataPagingCompiler"},orderBy:{allowedIn:[s["default"].Expressions.IncludeExpression],parameters:[{name:"orderBy",dataType:"$data.Queryable"}],frameType:s["default"].Expressions.OrderExpression,includeFrameName:"$orderby",includeCompiler:"$data.storageProviders.oData.oDataOrderCompiler"},orderByDescending:{allowedIn:[s["default"].Expressions.IncludeExpression],parameters:[{name:"orderByDescending",dataType:"$data.Queryable"}],frameType:s["default"].Expressions.OrderExpression,frameTypeFactory:function(e,t){return new s["default"].Expressions.OrderExpression(e,t,s["default"].Expressions.ExpressionType.OrderByDescending)},includeFrameName:"$orderby",includeCompiler:"$data.storageProviders.oData.oDataOrderCompiler"},first:{},include:{},batchDelete:{},withInlineCount:{allowedIn:[s["default"].Expressions.IncludeExpression],parameters:[],frameType:s["default"].Expressions.InlineCountExpression,includeFrameName:"$count",implementation:function(){return"true"}},find:{}},enumerable:!0,writable:!0},supportedContextOperation:{value:{batchExecuteQuery:!0},enumerable:!0,writable:!0},fieldConverter:{value:s["default"].oDataConverter},resolveTypeOperations:function(e,t,r){var a=t.entityType.getMemberDefinition(e);return a&&a.method&&a.method.IsSideEffecting===!1&&a.method.returnType&&(r===s["default"].Expressions.FilterExpression||r===s["default"].Expressions.OrderExpression)||o.Guard.raise(new o.Exception("Entity '"+t.entityType.name+"' Operation '"+e+"' is not supported by the provider")),a},resolveSetOperations:function(e,t,r){if(t){var a=t.storageModel.ContextType.getMemberDefinition(t.storageModel.ItemName);if(a&&a.actions&&a.actions[e]){var n=s["default"].MemberDefinition.translateDefinition(a.actions[e],e,this.getType());return n&&n.method&&n.method.IsSideEffecting===!1&&n.method.returnType&&(r===s["default"].Expressions.FilterExpression||r===s["default"].Expressions.OrderExpression)||o.Guard.raise(new o.Exception("Collection '"+t.storageModel.ItemName+"' Operation '"+e+"' is not supported by the provider")),n}}return s["default"].StorageProviderBase.prototype.resolveSetOperations.apply(this,arguments)},resolveContextOperations:function(e,t,r){var a=this.context.getType().getMemberDefinition(e);return a&&a.method&&a.method.IsSideEffecting===!1&&a.method.returnType&&(r===s["default"].Expressions.FilterExpression||r===s["default"].Expressions.OrderExpression)||o.Guard.raise(new o.Exception("Context '"+t.instance.getType().name+"' Operation '"+e+"' is not supported by the provider")),a},getEntityUrlReference:function(e){var t=this.context._storageModel.getStorageModel(e.getType()),r=t.TableName,a="("+this.getEntityKeysValue({data:e,entitySet:this.context.getEntitySetFromElementType(e.getType())})+")";return this.providerConfiguration.oDataServiceHost+"/"+r+a},getEntityKeysValue:function(e){for(var t=[],r=void 0,a=e.data.getType().memberDefinitions.getKeyProperties(),n=0,i=a.length;i>n;n++){var s=a[n];if(s.key){r=e.data[s.name];var d=o.Container.resolveName(s.type),u=this.fieldConverter.toDb[d];r=u?u(r):r,u=this.fieldConverter.escape[d],r=u?u(r):r,t.push(s.name+"="+r)}}return t.length>1?t.join(","):r},getFieldUrl:function(e,t,r){var a=this.getEntityKeysValue({data:e}),n=this.providerConfiguration.oDataServiceHost;return n.lastIndexOf("/")===n.length&&(n=n.substring(0,n.length-1)),n+"/"+r.tableName+"("+a+")/"+t+"/$value"},parseError:function(e,t){var r=(e.response||e||{}).body||"";try{if(0===r.indexOf("{")){var a=JSON.parse(r);a=a["odata.error"]||a.error||a,a.message&&(r=a.message.value||a.message)}}catch(n){}return new o.Exception(r,e.message,t||e)},appendBasicAuth:function(e,t,r,a){e.headers=e.headers||{},!e.headers.Authorization&&t&&r&&(e.headers.Authorization="Basic "+this.__encodeBase64(t+":"+r)),a&&(e.withCredentials=a)},__encodeBase64:function(e){var t,r,a,n,i,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=e,d="",u="",p="",l=0;do t=s.charCodeAt(l++),r=s.charCodeAt(l++),u=s.charCodeAt(l++),a=t>>2,n=(3&t)<<4|r>>4,i=(15&r)<<2|u>>6,p=63&u,isNaN(r)?i=p=64:isNaN(u)&&(p=64),d=d+o.charAt(a)+o.charAt(n)+o.charAt(i)+o.charAt(p),t=r=u="",a=n=i=p="";while(l<s.length);return d},checkODataMode:function(e){return c(this,e)}},null),s["default"].StorageProviderBase.registerProvider("oData",s["default"].storageProviders.oData.oDataProvider)},{"./SaveStrategies/batch":1,"./SaveStrategies/empty":2,"./SaveStrategies/single":3,"./oDataRequestActivities.js":12,"jaydata/core":"jaydata/core"}],12:[function(e,t,r){"use strict";function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=(r.RequestBuilder=function(){function e(t,r){i(this,e),this._context=t,this._request=r||{},this._activities=[]}return o(e,[{key:"get",value:function(){return this._request}},{key:"add",value:function(){var e;return(e=this._activities).push.apply(e,arguments),this}},{key:"build",value:function(){var e=this;return this._request.headers=this._request.headers||{},this._request.data=this._request.data||{},this._activities.forEach(function(t){return t instanceof s?t.implementation(e._request,e._context):t(e._request,e._context)}),this._activities=[],this}}]),e}(),r.RequestActivity=function(){function e(){i(this,e)}return o(e,[{key:"implementation",value:function(e,t){}}]),e}()),d=r.SetRequestActivity=function(e){function t(e,r){i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return n.key=e,n.value=r,n}return n(t,e),o(t,[{key:"implementation",value:function(e,t){}}]),t}(s),u=r.SetRequestProperty=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),o(t,[{key:"implementation",value:function(e,t){e[this.key]=this.value}}]),t}(d),p=r.SetDataProperty=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),o(t,[{key:"implementation",value:function(e,t){e.data[this.key]=this.value}}]),t}(d),l=(r.SetHeaderProperty=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),o(t,[{key:"implementation",value:function(e,t){e.headers[this.key]=this.value}}]),t}(d),r.SetUrl=function(e){function t(e){return i(this,t),a(this,Object.getPrototypeOf(t).call(this,"requestUri",e))}return n(t,e),t}(u));r.AppendUrl=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),o(t,[{key:"implementation",value:function(e,t){e[this.key]==e[this.key]||"",e[this.key]+=this.value}}]),t}(l),r.SetMethod=function(e){function t(e){return i(this,t),a(this,Object.getPrototypeOf(t).call(this,"method",e))}return n(t,e),t}(u),r.SetProperty=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),t}(p),r.SetNavigationProperty=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),o(t,[{key:"implementation",value:function(e,t){e.data[this.key]=this.value}}]),t}(p),r.ClearRequestData=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),o(t,[{key:"implementation",value:function(e,t){delete e.data}}]),t}(s)},{}],13:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var n=e("jaydata/core"),i=a(n);(0,n.$C)("$data.storageProviders.oData.oDataWhereCompiler",i["default"].Expressions.EntityExpressionVisitor,null,{constructor:function(e,t){this.provider=e,this.lambdaPrefix=t},compile:function(e,t){this.Visit(e,t)},VisitParametricQueryExpression:function(e,t){this.Visit(e.expression,t)},VisitUnaryExpression:function(e,t){t.data+=e.resolution.mapTo,t.data+="(",this.Visit(e.operand,t),t.data+=")"},VisitSimpleBinaryExpression:function(e,t){if(t.data+="(","in"==e.nodeType){n.Guard.requireType("expression.right",e.type,i["default"].Expressions.ConstantExpression);var r=e.right.value;r instanceof Array||n.Guard.raise(new n.Exception("Right to the 'in' operator must be an array value"));var a=null,o={mapTo:"or",dataType:"boolean",name:"or"},s={mapTo:"eq",dataType:"boolean",name:"equal"};r.forEach(function(t){var r=t,d=n.Container.createSimpleBinaryExpression(e.left,r,i["default"].Expressions.ExpressionType.Equal,"==","boolean",s);a=a?n.Container.createSimpleBinaryExpression(a,d,i["default"].Expressions.ExpressionType.Or,"||","boolean",o):d});var d=t.data;t.data="",this.Visit(a,t),t.data=d+t.data.replace(/\(/g,"").replace(/\)/g,"")}else this.Visit(e.left,t),t.data+=" ",t.data+=e.resolution.mapTo,t.data+=" ",this.Visit(e.right,t);t.data+=")"},VisitEntityFieldExpression:function(e,t){this.Visit(e.source,t),e.source instanceof i["default"].Expressions.ComplexTypeExpression&&(t.data+="/"),this.Visit(e.selector,t)},VisitAssociationInfoExpression:function(e,t){t.data+=e.associationInfo.FromPropertyName},VisitMemberInfoExpression:function(e,t){t.data+=e.memberName},VisitQueryParameterExpression:function(e,t){var r=n.Container.resolveName(e.type),a=this.provider.fieldConverter.toDb[r],i=a?a(e.value):e.value;a=this.provider.fieldConverter.escape[r],t.data+=a?a(i):i},VisitEntityFieldOperationExpression:function(e,t){n.Guard.requireType("expression.operation",e.operation,i["default"].Expressions.MemberInfoExpression);var r=e.operation.memberDefinition,a=r.mapTo||r.name;t.data+=a,t.data+="(";var o=0,s=r.parameters||[{name:"@expression"}],d=s.map(function(t,r){return"@expression"===t.name?e.source:e.parameters[o++]});d.forEach(function(e,r){r>0&&(t.data+=","),this.Visit(e,t)},this),t.data+=")"},VisitEntityFunctionOperationExpression:function(e,t){n.Guard.requireType("expression.operation",e.operation,i["default"].Expressions.MemberInfoExpression),this.Visit(e.source,t);var r=e.operation.memberDefinition,a=r.mapTo||r.name;t.data+=a,t.data+="(";var o=0,s=r.method.params||[{name:"@expression"}],d=s.map(function(t,r){return"@expression"===t.name?e.source:e.parameters[o++]}),u=0;d.forEach(function(e,r){void 0===e||e instanceof i["default"].Expressions.ConstantExpression&&"undefined"==typeof e.value||(u>0&&(t.data+=","),u++,t.data+=s[r].name+"=",this.Visit(e,t))},this),t.data+=")"},VisitContextFunctionOperationExpression:function(e,t){return this.VisitEntityFunctionOperationExpression(e,t)},VisitConstantExpression:function(e,t){var r=n.Container.resolveName(e.type),a=this.provider.fieldConverter.toDb[r],i=a?a(e.value):e.value;a=this.provider.fieldConverter.escape[r],t.data+=a?a(i):i},VisitEntityExpression:function(e,t){this.Visit(e.source,t),this.lambdaPrefix&&e.selector.lambda&&(t.lambda=e.selector.lambda,t.data+=e.selector.lambda+"/")},VisitEntitySetExpression:function(e,t){this.Visit(e.source,t),e.selector instanceof i["default"].Expressions.AssociationInfoExpression&&(this.Visit(e.selector,t),t.data+="/")},VisitFrameOperationExpression:function(e,t){this.Visit(e.source,t),n.Guard.requireType("expression.operation",e.operation,i["default"].Expressions.MemberInfoExpression);var r=e.operation.memberDefinition,a=r.mapTo||r.name;t.data+=a,t.data+="(";for(var o=0,s=r.parameters||[{name:"@expression"}],d=s.map(function(t,r){return"@expression"===t.name?e.source:e.parameters[o++]}),u=0;u<d.length;u++){var p=d[u];if(!r.method){var l=new i["default"].storageProviders.oData.oDataWhereCompiler(this.provider,!0),f={data:""};if(p&&p.value instanceof i["default"].Queryable){var c=n.Container.createQueryExpressionCreator(p.value.entityContext),y=c.Visit(p.value.expression);p=y}else p&&(p=p.selector);l.compile(p,f);f.data&&(t.data+=f.lambda+": "+f.data)}}t.data+=")"}})},{"jaydata/core":"jaydata/core"}]},{},[4])(4)});
//# sourceMappingURL=oDataProvider.min.js.map
